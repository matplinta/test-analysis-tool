#!/usr/bin/env python3

"""
:author: Mateusz Plinta
:contact: mateusz.plinta@.com
:description:
"""
from rep_api import RepApi
import json
import re


_re_egate_timer_expired = "It was not possible to find string after 15\.0 secs to match regexp \(Received REGISTRATION COMPLETE fCellId:50\]\[RNTI:0x88\]RAR Timer has expired;"
_re_wts_went_wrong = "Something went wrong during setting up WTS"


DATA = {'count': 4590, 'next': 'https://rep-portal.wroclaw.nsn-rdnet.net/api/automatic-test/runs/report/?fields=no%2Cid%2Cresult_color%2Cqc_test_instance__m_path%2Cqc_test_set%2Ctest_case__qc_instance_number%2Ctest_case__name%2Chyperlink_set__test_logs_url%2Crain_url%2Curl%2Cconfiguration%2Cqc_test_instance__res_tester%2Cend%2Cresult%2Cenv_issue_type%2Ccomment%2Ctest_line%2Cpronto%2Ctest_col__testline_type%2Cbuilds%2Cqc_test_instance__organization%2Ctest_exception_message%2Ctest_lab_path&limit=30&offset=30&result__name__pos_neg=passed&stat_n4_manager=%22mmech%22', 'previous': None, 'results': [{'id': 61590384, 'test_col': {'testline_type': 'CLOUD_5G_I_LO_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001085_B_003_Empty_gnbIdLengthConfig_object_-_trigger_ANR', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\5GC001085_ANR_for_SA_intra-NR_intra-frequency_UE_based'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL1944', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832912/execution_for_preparation_f6c7a567-f4c5-4bf1-9076-d12aaf23f658/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832912/'}, 'configuration': {'id': 'ae930786471120cc', 'url': '/details/configuration/ae930786471120cc/'}, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001085-B_Intra-frequency_inter-gNB_neighbor_NRREL_addition_-_Previously_established_Xn', 'url': '/at/test_runs/?id=61590384', 'end': '2022-03-23T16:50:50.200000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61588744, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001085_C_008_Removal_due_to_consecutive_HO_failures_-_intra-gnb_and_inter-gnb', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC001085'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL1197', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833593/execution_for_preparation_aaeeddb1-b35f-4258-a32a-e42df33a486a/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833593/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001085-C_Intra-frequency_NRREL_deletion_(Pruning)_based_on_Measurement_Reports', 'url': '/at/test_runs/?id=61588744', 'end': '2022-03-23T16:40:42.179000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61588741, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001085_C_005_ANR_disabled_-_check_removal_due_to_Handover_failures', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC001085'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL1197', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833593/execution_for_preparation_aaeeddb1-b35f-4258-a32a-e42df33a486a/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833593/'}, 'configuration': None, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001085-C_Intra-frequency_NRREL_deletion_(Pruning)_based_on_Measurement_Reports', 'url': '/at/test_runs/?id=61588741', 'end': '2022-03-23T16:25:24.217000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61588738, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001085_C_003_Check_periodic_removal_of_various_NRREL_and_NRADJNRCELL', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC001085'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL1197', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833593/execution_for_preparation_aaeeddb1-b35f-4258-a32a-e42df33a486a/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833593/'}, 'configuration': None, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001085-C_Intra-frequency_NRREL_deletion_(Pruning)_based_on_Measurement_Reports', 'url': '/at/test_runs/?id=61588738', 'end': '2022-03-23T16:11:01.146000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61585124, 'test_col': {'testline_type': 'CLOUD_5G_I_LO_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC002001_Switching_feature_on_with_4_beams_configured', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Kozmic Jacek Piotr (kozmic)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\5GC002001_SSB_Muting'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL1472', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832849/execution_for_preparation_aaace74c-c9a7-4cd2-90cb-e11342d7828d/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832849/'}, 'configuration': {'id': 'fef3d03ba594efd7', 'url': '/details/configuration/fef3d03ba594efd7/'}, 'pronto': [], 'comment': '', 'qc_test_set': '5GC002001_A-b', 'url': '/at/test_runs/?id=61585124', 'end': '2022-03-23T16:02:22.222000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61582879, 'test_col': {'testline_type': ''}, 'test_case': {'name': '5GC001294-A_Req_35_A5G_FD_1S-1CC-4DL-4UL-FR1-CPRI_SA_FDD_AHLOA_ASIB_ABIO_IRC_no_interference_1UE_1TX_4Rx_L1_support_4Rx_IRC_in_Msg3_and_PUSCH', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Skala Tomasz (tskala)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\Trunk\\RAN_L2_SW_KRK_2\\5GC001294_4rx_IRC_for_beamforming_and_non-beamforming_cells'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2133', 'env_issue_type': None, 'builds': 'SBTS00_ENB_9999_220317_000004', 'result_color': 'green', 'hyperlink_set': None, 'configuration': None, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001294-A', 'url': '/at/test_runs/?id=61582879', 'end': '2022-03-23T15:40:35', 'rain_url': None, 'test_exception_message': ''}, {'id': 61582874, 'test_col': {'testline_type': ''}, 'test_case': {'name': '5GC001294-A_Req_45_A5G_FD_1S-1CC-4DL-4UL-FR1-CPRI_SA_FDD_AHLOA_ASIB_ABIO_IRC_no_interference_1UE_1TX_4Rx_report_rxPowerOfAnt_PUSCH', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Skala Tomasz (tskala)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\Trunk\\RAN_L2_SW_KRK_2\\5GC001294_4rx_IRC_for_beamforming_and_non-beamforming_cells'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2133', 'env_issue_type': None, 'builds': 'SBTS00_ENB_9999_220317_000004', 'result_color': 'green', 'hyperlink_set': None, 'configuration': None, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001294-A', 'url': '/at/test_runs/?id=61582874', 'end': '2022-03-23T15:40:30', 'rain_url': None, 'test_exception_message': ''}, {'id': 61582865, 'test_col': {'testline_type': ''}, 'test_case': {'name': '5GC001294-A_Req_45_A5G_FD_1S-1CC-4DL-4UL-FR1-CPRI_SA_FDD_AHLOA_ASIB_ABIO_IRC_no_interference_1UE_1TX_4Rx_report_rxPowerOfAnt_SRS', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Skala Tomasz (tskala)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\Trunk\\RAN_L2_SW_KRK_2\\5GC001294_4rx_IRC_for_beamforming_and_non-beamforming_cells'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2133', 'env_issue_type': None, 'builds': 'SBTS00_ENB_9999_220317_000004', 'result_color': 'green', 'hyperlink_set': None, 'configuration': None, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001294-A', 'url': '/at/test_runs/?id=61582865', 'end': '2022-03-23T15:40:24', 'rain_url': None, 'test_exception_message': ''}, {'id': 61588735, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001085_C_001_ANR_disabled_-_check_periodic_removal', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC001085'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL1197', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833593/execution_for_preparation_aaeeddb1-b35f-4258-a32a-e42df33a486a/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833593/'}, 'configuration': None, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001085-C_Intra-frequency_NRREL_deletion_(Pruning)_based_on_Measurement_Reports', 'url': '/at/test_runs/?id=61588735', 'end': '2022-03-23T15:36:27.170000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61580442, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC002175-RB-0006_NGAP_Path_Switch_Request_invalid_response_message', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC002175'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2343', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833009/execution_for_preparation_ef8f50b0-01a0-4e84-a6e6-7129c0b94cff/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833009/'}, 'configuration': None, 'pronto': [], 'comment': '', 'qc_test_set': '5GC002175-RB', 'url': '/at/test_runs/?id=61580442', 'end': '2022-03-23T15:20:22.673000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61580440, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC002175-RB-0005_NGAP_Path_Switch_Request_ACK_PDU_session_ID_error', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC002175'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2343', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833009/execution_for_preparation_ef8f50b0-01a0-4e84-a6e6-7129c0b94cff/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833009/'}, 'configuration': None, 'pronto': [], 'comment': '', 'qc_test_set': '5GC002175-RB', 'url': '/at/test_runs/?id=61580440', 'end': '2022-03-23T15:12:53.569000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61577919, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001778-B-008_Change_single_cell_to_global_tracing', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Kozmic Jacek Piotr (kozmic)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2342', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833109/execution_for_preparation_ceed72fc-2caa-44b3-8189-4065c3b1bcaa/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833109/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': 'CB007326_5GC001778', 'url': '/at/test_runs/?id=61577919', 'end': '2022-03-23T14:35:25.436000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61577916, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001778-B-007_Change_global_tracing_to_single_cell', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Kozmic Jacek Piotr (kozmic)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2342', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833109/execution_for_preparation_ceed72fc-2caa-44b3-8189-4065c3b1bcaa/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833109/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': 'CB007326_5GC001778', 'url': '/at/test_runs/?id=61577916', 'end': '2022-03-23T14:23:38.226000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61576999, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001085_A_025_No_ANR_Profile_created_-_cancel_ANR', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC001085'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2348', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/execution_for_preparation_f4f1aec6-f6e3-43e1-9154-12dec5ed9bad/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001085-A_Intra-frequency_intra-gNB_neighbor_NRREL_addition', 'url': '/at/test_runs/?id=61576999', 'end': '2022-03-23T14:22:49.464000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61577910, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001778-B-004_Deactivation_of_one_cell_tracing', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Kozmic Jacek Piotr (kozmic)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2342', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833109/execution_for_preparation_ceed72fc-2caa-44b3-8189-4065c3b1bcaa/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833109/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': 'CB007326_5GC001778', 'url': '/at/test_runs/?id=61577910', 'end': '2022-03-23T14:11:45.885000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61576997, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001085_A_024_Use_dedicated_ANR_Profile_instead_of_Default_Profile', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC001085'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2348', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/execution_for_preparation_f4f1aec6-f6e3-43e1-9154-12dec5ed9bad/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001085-A_Intra-frequency_intra-gNB_neighbor_NRREL_addition', 'url': '/at/test_runs/?id=61576997', 'end': '2022-03-23T14:04:49.979000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61577906, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001778-B-003_Activation_of_one_cell_tracing', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Kozmic Jacek Piotr (kozmic)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2342', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833109/execution_for_preparation_ceed72fc-2caa-44b3-8189-4065c3b1bcaa/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833109/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': 'CB007326_5GC001778', 'url': '/at/test_runs/?id=61577906', 'end': '2022-03-23T14:01:26.465000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61576995, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001085_A_020_NRREL_Creation_failed_-_maxNumAnrNrrelAllowed_exceeded', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC001085'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2348', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/execution_for_preparation_f4f1aec6-f6e3-43e1-9154-12dec5ed9bad/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001085-A_Intra-frequency_intra-gNB_neighbor_NRREL_addition', 'url': '/at/test_runs/?id=61576995', 'end': '2022-03-23T13:47:13.877000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61580435, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC002175-RB-0002_NGAP_Error_Indication_other_protocol_error', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC002175'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2343', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833009/execution_for_preparation_ef8f50b0-01a0-4e84-a6e6-7129c0b94cff/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833009/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': '5GC002175-RB', 'url': '/at/test_runs/?id=61580435', 'end': '2022-03-23T13:36:52.477000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61580433, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC002175-RB-0001_NGAP_Error_Indication_NGAP_ID_error', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC002175'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2343', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833009/execution_for_preparation_ef8f50b0-01a0-4e84-a6e6-7129c0b94cff/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833009/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': '5GC002175-RB', 'url': '/at/test_runs/?id=61580433', 'end': '2022-03-23T13:24:51.670000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61576990, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001085_A_013_Confirmed_and_Unknown_PCIs_received_in_A3_Measurement_Report_-_perform_Handover', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC001085'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2348', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/execution_for_preparation_f4f1aec6-f6e3-43e1-9154-12dec5ed9bad/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001085-A_Intra-frequency_intra-gNB_neighbor_NRREL_addition', 'url': '/at/test_runs/?id=61576990', 'end': '2022-03-23T12:57:02.733000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61576988, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001085_A_012_Resolved_unknown_cell_forbidden_by_MRL', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC001085'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2348', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/execution_for_preparation_f4f1aec6-f6e3-43e1-9154-12dec5ed9bad/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001085-A_Intra-frequency_intra-gNB_neighbor_NRREL_addition', 'url': '/at/test_runs/?id=61576988', 'end': '2022-03-23T12:47:27.518000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61576986, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001085_A_011_Only_Unknown_PCIs_received_in_A3_Measurement_Report_-_perform_ANR', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC001085'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2348', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/execution_for_preparation_f4f1aec6-f6e3-43e1-9154-12dec5ed9bad/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001085-A_Intra-frequency_intra-gNB_neighbor_NRREL_addition', 'url': '/at/test_runs/?id=61576986', 'end': '2022-03-23T12:37:58.538000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61576979, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001085_A_005_RSRP_threshold_for_ANR_not_met', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC001085'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2348', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/execution_for_preparation_f4f1aec6-f6e3-43e1-9154-12dec5ed9bad/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001085-A_Intra-frequency_intra-gNB_neighbor_NRREL_addition', 'url': '/at/test_runs/?id=61576979', 'end': '2022-03-23T12:22:06.770000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61576978, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001085_A_003_NRREL_Creation_failed_-_number_of_NR_ANR_MOI_exceeded', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC001085'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2348', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/execution_for_preparation_f4f1aec6-f6e3-43e1-9154-12dec5ed9bad/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001085-A_Intra-frequency_intra-gNB_neighbor_NRREL_addition', 'url': '/at/test_runs/?id=61576978', 'end': '2022-03-23T12:05:32.236000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61580430, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC002175-QB-0001_NGAP_Error_Indication', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC002175'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2343', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833009/execution_for_preparation_ef8f50b0-01a0-4e84-a6e6-7129c0b94cff/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13833009/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': '5GC002175-QB', 'url': '/at/test_runs/?id=61580430', 'end': '2022-03-23T11:48:41.554000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61576977, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001085_A_002_Feature_flag_deactivated_-_unknown_PCI_received', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC001085'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2348', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/execution_for_preparation_f4f1aec6-f6e3-43e1-9154-12dec5ed9bad/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001085-A_Intra-frequency_intra-gNB_neighbor_NRREL_addition', 'url': '/at/test_runs/?id=61576977', 'end': '2022-03-23T11:46:57.741000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61576976, 'test_col': {'testline_type': 'CLOUD_5G_O_E_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC001085_A_001_Feature_flag_activation_and_deactivation', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\22R2\\Regression\\RAN_L2_SW_KRK_2\\CB007326_5G_feature_porting_for_FR1_TDD_ASOE\\5GC001085'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL2348', 'env_issue_type': None, 'builds': 'SBTS22R2_ENB_0000_001050_000000', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/execution_for_preparation_f4f1aec6-f6e3-43e1-9154-12dec5ed9bad/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13832969/'}, 'configuration': {'id': 'b69b35420849db92', 'url': '/details/configuration/b69b35420849db92/'}, 'pronto': [], 'comment': '', 'qc_test_set': '5GC001085-A_Intra-frequency_intra-gNB_neighbor_NRREL_addition', 'url': '/at/test_runs/?id=61576976', 'end': '2022-03-23T11:30:54.998000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61545485, 'test_col': {'testline_type': 'CLOUD_5G_I_LO_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC002175-RB-0006_NGAP_Path_Switch_Request_invalid_response_message', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\Trunk\\RAN_L2_SW_KRK_2\\5GC002175_Spillover_from_SA_Mobility_(5GC000704_5GC000708)'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL1582', 'env_issue_type': None, 'builds': 'SBTS00_ENB_9999_220321_000012', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13822965/execution_for_preparation_2a8b0a57-7748-425e-8e1f-4ada822bce97/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13822965/'}, 'configuration': None, 'pronto': [], 'comment': '', 'qc_test_set': '5GC002175-RB', 'url': '/at/test_runs/?id=61545485', 'end': '2022-03-23T06:55:46.923000', 'rain_url': None, 'test_exception_message': ''}, {'id': 61545481, 'test_col': {'testline_type': 'CLOUD_5G_I_LO_AP_LO_SANSA_FS_ECPRI_CMWV_TDD'}, 'test_case': {'name': '5GC002175-RB-0005_NGAP_Path_Switch_Request_ACK_PDU_session_ID_error', 'qc_instance_number': 1}, 'qc_test_instance': {'res_tester': 'Flaum Maciej Mieczyslaw (flaum)', 'organization': 'RAN_L2_SW_KRK_2_SG02', 'm_path': 'Root\\Test_Sets\\Trunk\\RAN_L2_SW_KRK_2\\5GC002175_Spillover_from_SA_Mobility_(5GC000704_5GC000708)'}, 'result': 'passed', 'test_line': 'MN Trunk Engine_Wroclaw_UTE5GCLASSICAL1582', 'env_issue_type': None, 'builds': 'SBTS00_ENB_9999_220321_000012', 'result_color': 'green', 'hyperlink_set': {'log_file_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13822965/execution_for_preparation_2a8b0a57-7748-425e-8e1f-4ada822bce97/test_results/log.html', 'test_logs_url': 'http://logs.ute.nsn-rdnet.net/cloud/execution/13822965/'}, 'configuration': {'id': 'ae930786471120cc', 'url': '/details/configuration/ae930786471120cc/'}, 'pronto': [], 'comment': '', 'qc_test_set': '5GC002175-RB', 'url': '/at/test_runs/?id=61545481', 'end': '2022-03-23T06:48:49.377000', 'rain_url': None, 'test_exception_message': ''}]}

class RepPortal():


    def __init__(self):
        self.user = 'sc'
        self.log = 'Pico1234^'
        self.basic_url = 'https://rep-portal.wroclaw.nsn-rdnet.net/api/automatic-test/'

        self._default_dict = {"common_build": None, "pronto": "", "default_blocked": "true", "runs": None,
                              "send_to_qc": "false", "result": None, "comment": None}
        self._test_run_results = ["passed", "failed", "blocked", "environment issue"]
        self._env_issue_type = ["Precondition", "TA_SCRIPT", "Other", "BTS", "TOOLS", "UTE",
                                "TA_FRAMEWORK", "iPHY", "LMTS", "RealUE", "TM500", "Robustness",
                                "Env_gNB", "Pre Check", "iphy", "RTG", "Renesas"]


    def _build_get_url(self, limit=30, result=None):
        parsed_result = ''
        basic_url = '{}{}'.format(self.basic_url, 'runs/report/?fields=no,id,result_color,qc_test_instance__m_path,')
        params1 = 'qc_test_set,test_case__qc_instance_number,test_case__name,hyperlink_set__test_logs_url,rain_url,'
        params2 = 'url,configuration,qc_test_instance__res_tester,end,result,env_issue_type,comment,test_line,pronto,'
        params3 = 'test_col__testline_type,builds,qc_test_instance__organization,test_exception_message,test_lab_path'
        suburl = '{}{}{}{}'.format(basic_url, params1, params2, params3)
        url_limit = '{}&limit={}'.format(suburl, str(limit))
        if result:
            parsed_result = result.replace(' ', '+')
        return '{}&result__name__pos_neg={}&stat_n4_manager=%22mmech%22'.format(url_limit, parsed_result)


    def get_data_and_filter(self, filter_dict, limit=30):
        url = self._build_get_url(limit, result='passed')
        with RepApi(username=self.user, password=self.log, config='rep-prod-one') as api:
            data = api.get(url, params=None)
        filtered_data = data.json()['results']
        for key, msg in filter_dict.items():
            filtered_data = self._get_test_dict_with_msg(msg, filtered_data, key)
        return filtered_data


    def get_test_lab_path_results_with_given_msg(self, msg, limit=30, test_object=None, organization=None):
        url = self._build_get_url(limit, result='passed')
        with RepApi(username=self.user, password=self.log, config='rep-prod-one') as api:
            data = api.get(url, params=None)
        data_dict = data.json()
        return self._get_test_dict_with_msg(msg, data_dict['results'], 'test_lab_path')


    def get_qc_test_set_results_with_given_msg(self, msg, limit=30, test_object=None, organization=None):
        url = self._build_get_url(limit, result='passed')
        with RepApi(username=self.user, password=self.log, config='rep-prod-one') as api:
            data = api.get(url, params=None)
        data_dict = data.json()
        return self._get_test_dict_with_msg(msg, data_dict['results'], 'qc_test_set')


    def get_test_results_with_given_msg(self, msg, limit=30, result='not analyzed'):
        url = self._build_get_url(limit, result)
        with RepApi(username=self.user, password=self.log, config='rep-prod-one') as api:
            data = api.get(url, params=None)
        data_dict = data.json()
        return self._get_test_dict_with_msg(msg, data_dict['results'], 'test_exception_message')


    def _get_test_dict_with_msg(self, msg, data_list, search_key):
        if isinstance(data_list, list):
            selected_data = list()
            for test_run in data_list:
                if isinstance(search_key, tuple):
                    key = self._handle_tuple_key(search_key, test_run)
                else:
                    key = test_run[search_key]
                if re.search(msg, key):
                    selected_data.append(test_run)
            return selected_data


    def _handle_tuple_key(self, search_key, test_run):
        key = test_run
        for item in search_key:
            try:
                key = key[item]
            except KeyError:
                key = "Doesn't have excpected key"
        return key


    def _extract_data_from_selected_tests(self, selected_data):
        extracted_tests_info = dict()
        for test in selected_data:
            id = test['id']
            build = test['builds']
            self._parse_to_dict(extracted_tests_info, id, build)
        return extracted_tests_info


    def _parse_to_dict(self, adict, id, build):
        if build in adict:
            adict[build].append(str(id))
        else:
            adict.update({build: [str(id)]})


    def _build_post_url(self, ids_list):
        basic_url = '{}{}'.format(self.basic_url, 'runs-analyze/?ids=')
        ids = ','.join(ids_list)
        return '{}{}'.format(basic_url, ids)


    def _create_post_info_dict(self, result, comment, env_issue_type=None, build=None):
        post_info_dict = self._default_dict
        post_info_dict["comment"] = comment
        if result in self._test_run_results:
            post_info_dict["result"] = result
            self._set_env_issue_type(post_info_dict, result, env_issue_type)
        #TODO raise error
        return post_info_dict


    def _set_env_issue_type(self, post_info_dict, result, env_issue_type):
        if result == "environment issue":
            if env_issue_type in self._env_issue_type:
                post_info_dict.update({"env_issue_type": env_issue_type})
        #TODO raise error


    def _post_all_test_results(self, extracted_tests_info, param_dict):
        for build in extracted_tests_info.keys():
            url = self._build_post_url(extracted_tests_info[build])
            param_dict['common_build'] = build
            param_dict['runs'] = extracted_tests_info[build]
            self._post_test_result(url, param_dict)



    #data = get_test_results_with_given_msg(msg=_re_wts_went_wrong)
    #extracted_tests_info = _extract_data_from_selected_tests(data)
    #com = _create_post_info_dict(result="environment issue", comment = 'gnb not on-Air', env_issue_type="iPHY")
    #_post_all_test_results(extracted_tests_info, com)

_re_qc_msg = r'5GC001085-B'
data = RepPortal().get_data_and_filter({('qc_test_instance', 'organization'):r'RAN_L2',
                                        'qc_test_set':'gNB_neighbor_NRREL_and_Xn_addition_SON_Config_Transfer',
                                        'end':'2022-03-24T01'})
print(data)


